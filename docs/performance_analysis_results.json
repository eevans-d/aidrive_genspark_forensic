{
  "timestamp": "2025-11-02T13:48:44.425229",
  "analysis_type": "performance_critical_optimization",
  "targets": {
    "memory_reduction": {
      "current": "596MB",
      "target": "<300MB",
      "improvement": "50%+"
    },
    "throughput_increase": {
      "current": "213 req/seg",
      "target": "1,000 req/seg",
      "improvement": "370%+"
    },
    "accuracy_improvement": {
      "current": "92.90%",
      "target": "95%+",
      "improvement": "2.1%+"
    },
    "response_time": {
      "current": "1800ms",
      "target": "<1000ms",
      "improvement": "44%+"
    }
  },
  "files_analyzed": [
    "/workspace/supabase/functions/scraper-maxiconsumo/index.ts",
    "/workspace/supabase/functions/api-proveedor/index.ts"
  ],
  "performance_issues": {
    "total_memory_issues": 80,
    "total_throughput_issues": 99,
    "total_accuracy_issues": 741,
    "total_caching_opportunities": 16
  },
  "memory_analysis": {},
  "throughput_bottlenecks": {},
  "caching_opportunities": [],
  "refactoring_plan": {
    "priority_order": [
      "/workspace/supabase/functions/scraper-maxiconsumo/index.ts",
      "/workspace/supabase/functions/api-proveedor/index.ts"
    ],
    "modules_to_extract": [
      {
        "file": "/workspace/supabase/functions/scraper-maxiconsumo/index.ts",
        "suggested_modules": [
          "index_auth",
          "index_validation",
          "index_utils",
          "index_cache"
        ],
        "estimated_reduction": "1200-2000 lines"
      },
      {
        "file": "/workspace/supabase/functions/api-proveedor/index.ts",
        "suggested_modules": [
          "index_auth",
          "index_validation",
          "index_utils",
          "index_cache"
        ],
        "estimated_reduction": "1200-2000 lines"
      }
    ],
    "performance_optimizations": [
      {
        "type": "MEMORY_OPTIMIZATION",
        "actions": [
          "Implementar object pooling para requests recurrentes",
          "Usar WeakMap para referencias temporales",
          "Implement streaming para large datasets",
          "Optimize garbage collection con --max-old-space-size"
        ],
        "estimated_memory_reduction": "200-300MB"
      },
      {
        "type": "THROUGHPUT_OPTIMIZATION",
        "actions": [
          "Implementar Promise.all para operaciones paralelas",
          "Connection pooling para database",
          "Batch processing para multiple inserts",
          "Implement queue system para rate limiting inteligente"
        ],
        "estimated_throughput_increase": "400-600%"
      },
      {
        "type": "ACCURACY_OPTIMIZATION",
        "actions": [
          "Robust error handling con exponential backoff",
          "Multi-selector fallback chains",
          "Data validation layers",
          "Implement data quality scoring"
        ],
        "estimated_accuracy_increase": "2.5-3.5%"
      }
    ],
    "caching_strategy": {
      "layers": [
        {
          "level": "APPLICATION",
          "type": "In-memory LRU cache",
          "data": "API responses, computed results",
          "ttl": "5-15 minutes"
        },
        {
          "level": "DATABASE",
          "type": "Query result caching",
          "data": "Static data, product catalogs",
          "ttl": "1-6 hours"
        },
        {
          "level": "HTTP",
          "type": "Response caching",
          "data": "Static assets, API responses",
          "ttl": "30 minutes - 24 hours"
        }
      ],
      "estimated_performance_gain": "300-500% response time improvement"
    },
    "estimated_impact": {
      "memory_reduction": "300-400MB (50-67% reduction)",
      "throughput_increase": "500-800% (213 → 1,000+ req/seg)",
      "accuracy_improvement": "2.5-3.5% (92.90% → 95.5%+)",
      "response_time": "1800ms → 600-800ms (56-67% improvement)",
      "roi": "800-1200% in 3-6 months"
    },
    "implementation_phases": [
      {
        "phase": 1,
        "name": "Critical Refactoring",
        "duration": "1-2 weeks",
        "focus": "Split monolithic files, implement basic caching",
        "expected_gains": "Memory: -200MB, Throughput: +200%"
      },
      {
        "phase": 2,
        "name": "Performance Optimization",
        "duration": "1-2 weeks",
        "focus": "Parallel processing, connection pooling, optimization",
        "expected_gains": "Throughput: +300%, Response time: -40%"
      },
      {
        "phase": 3,
        "name": "Advanced Optimization",
        "duration": "1 week",
        "focus": "Advanced caching, accuracy improvements",
        "expected_gains": "Accuracy: +2.5%, Memory: additional -100MB"
      }
    ]
  },
  "overall_performance_score": 0.0,
  "detailed_file_analysis": {
    "/workspace/supabase/functions/scraper-maxiconsumo/index.ts": {
      "file_path": "/workspace/supabase/functions/scraper-maxiconsumo/index.ts",
      "lines": 3213,
      "size_kb": 112.0244140625,
      "memory_analysis": {
        "large_arrays": [
          {
            "line": 451,
            "content": "const failureCount = results.filter(r => r.status === 'rejected').length;",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 1501,
            "content": "alta_confianza: comparacionesValidas.filter(c => c.confidence_score > 70).length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 1502,
            "content": "media_confianza: comparacionesValidas.filter(c => c.confidence_score >= 50 && c.confidence_score <= ",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 1503,
            "content": "baja_confianza: comparacionesValidas.filter(c => c.confidence_score < 50).length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 1504,
            "content": "oportunidades_criticas: comparacionesValidas.filter(c => c.diferencia_porcentual > 20).length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 1514,
            "content": "oportunidades_ahorro: comparacionesValidas.filter(c => c.es_oportunidad_ahorro).length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 2010,
            "content": "alertas_criticas: alertasConSeveridad.filter(a => a.severidad === 'critica').length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 2011,
            "content": "alertas_altas: alertasConSeveridad.filter(a => a.severidad === 'alta').length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 2012,
            "content": "alertas_medias: alertasConSeveridad.filter(a => a.severidad === 'media').length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 2013,
            "content": "alertas_bajas: alertasConSeveridad.filter(a => a.severidad === 'baja').length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 2015,
            "content": "aumentos: alertasConSeveridad.filter(a => a.tipo_cambio === 'aumento').length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 2016,
            "content": "disminuciones: alertasConSeveridad.filter(a => a.tipo_cambio === 'disminucion').length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 2017,
            "content": "nuevos_productos: alertasConSeveridad.filter(a => a.tipo_cambio === 'nuevo_producto').length",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 2019,
            "content": "productos_afectados: new Set(alertasConSeveridad.map(a => a.producto_id)).size,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 2278,
            "content": "const subidaCount = tendencias.filter(t => t === 'subida').length;",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 2279,
            "content": "const bajadaCount = tendencias.filter(t => t === 'bajada').length;",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 2628,
            "content": "const openBreakers = Array.from(CIRCUIT_BREAKERS.values()).filter(cb => cb.state === 'OPEN').length;",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          }
        ],
        "string_concatenations": [],
        "closures": [
          {
            "line": 3212,
            "content": "return new Promise(resolve => setTimeout(resolve, ms + jitter));",
            "issue": "Closure potencial memory leak",
            "impact": "HIGH"
          }
        ],
        "memory_leaks": [
          {
            "line": 257,
            "content": "let response: Response;",
            "issue": "Variable HTTP no const, posible memory leak",
            "impact": "MEDIUM"
          },
          {
            "line": 559,
            "content": "let response: Response;",
            "issue": "Variable HTTP no const, posible memory leak",
            "impact": "MEDIUM"
          }
        ],
        "inefficient_loops": [
          {
            "line": 385,
            "content": "for (let i = 0; i < categoriasAProcesar.length; i += batchSize) {",
            "issue": "Loop accede .length en cada iteración",
            "impact": "MEDIUM"
          },
          {
            "line": 1147,
            "content": "for (let i = 0; i < productos.length; i += batchSize) {",
            "issue": "Loop accede .length en cada iteración",
            "impact": "MEDIUM"
          },
          {
            "line": 1230,
            "content": "for (let i = 0; i < skus.length; i += chunkSize) {",
            "issue": "Loop accede .length en cada iteración",
            "impact": "MEDIUM"
          },
          {
            "line": 1408,
            "content": "for (let i = 0; i < array.length; i += batchSize) {",
            "issue": "Loop accede .length en cada iteración",
            "impact": "MEDIUM"
          },
          {
            "line": 1743,
            "content": "for (let i = 0; i < Math.min(100, productosSistema.length); i++) {",
            "issue": "Loop accede .length en cada iteración",
            "impact": "MEDIUM"
          },
          {
            "line": 1856,
            "content": "for (let i = 0; i < comparaciones.length; i += batchSize) {",
            "issue": "Loop accede .length en cada iteración",
            "impact": "MEDIUM"
          },
          {
            "line": 2159,
            "content": "for (let i = 0; i < Math.min(cambios.length - 1, 3); i++) {",
            "issue": "Loop accede .length en cada iteración",
            "impact": "MEDIUM"
          },
          {
            "line": 2272,
            "content": "for (let i = 1; i < precios.length; i++) {",
            "issue": "Loop accede .length en cada iteración",
            "impact": "MEDIUM"
          },
          {
            "line": 2789,
            "content": "for (let i = 0; i < alertas.length; i += batchSize) {",
            "issue": "Loop accede .length en cada iteración",
            "impact": "MEDIUM"
          }
        ],
        "memory_score": 0
      },
      "throughput_analysis": {
        "synchronous_operations": [],
        "blocking_io": [
          {
            "line": 261,
            "content": "response = await ejecutarScrapingCompleto(supabaseUrl, serviceRoleKey, sanitizedCategoria, corsHeade",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 264,
            "content": "response = await compararPreciosOptimizado(supabaseUrl, serviceRoleKey, corsHeaders, requestId, stru",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 267,
            "content": "response = await generarAlertasOptimizado(supabaseUrl, serviceRoleKey, corsHeaders, requestId, struc",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 270,
            "content": "response = await obtenerEstadoScrapingOptimizado(supabaseUrl, serviceRoleKey, corsHeaders, requestId",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 273,
            "content": "response = await getHealthCheck(supabaseUrl, serviceRoleKey, corsHeaders, requestId, structuredLog);",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 367,
            "content": "const connectionPool = await initializeConnectionPool(supabaseUrl, serviceRoleKey);",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 569,
            "content": "const captchaResponse = await fetch(captchaCheckUrl, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 592,
            "content": "response = await fetchWithAdvancedAntiDetection(urlCategoria, headers, categoriaLog);",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 677,
            "content": "const response = await fetch(url, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 1090,
            "content": "const response = await fetch(url, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 1165,
            "content": "const existingProducts = await bulkCheckExistingProducts(skus, supabaseUrl, serviceRoleKey);",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 1181,
            "content": "const insertedCount = await batchInsertProducts(batch, supabaseUrl, serviceRoleKey, structuredLog);",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 1187,
            "content": "const updatedCount = await batchUpdateProducts(batch, supabaseUrl, serviceRoleKey, structuredLog);",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 1240,
            "content": "const response = await fetch(query, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 1295,
            "content": "const response = await fetch(`${supabaseUrl}/rest/v1/precios_proveedor`, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 1307,
            "content": "const inserted = await response.json();",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 1348,
            "content": "const response = await fetch(",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 1496,
            "content": "const guardadas = await batchSaveComparations(comparacionesValidas, supabaseUrl, serviceRoleKey, str",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 1557,
            "content": "const response = await fetch(query, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 1592,
            "content": "const response = await fetch(query, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 1844,
            "content": "await fetch(`${supabaseUrl}/rest/v1/comparacion_precios?fecha_comparacion=lt.${thirtyDaysAgo}`, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 1859,
            "content": "const response = await fetch(`${supabaseUrl}/rest/v1/comparacion_precios`, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 1925,
            "content": "await fetch(`${supabaseUrl}/rest/v1/comparacion_precios`, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 2005,
            "content": "const alertasGuardadas = await batchSaveAlertsOptimizado(alertasConSeveridad, supabaseUrl, serviceRo",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 2070,
            "content": "const response = await fetch(query, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 2091,
            "content": "const response = await fetch(query, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 2116,
            "content": "const response = await fetch(query, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 2355,
            "content": "await fetch(`${supabaseUrl}/rest/v1/alertas_cambios_precios`, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 2504,
            "content": "const response = await fetch(",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 2525,
            "content": "const response = await fetch(",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 2546,
            "content": "const response = await fetch(",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 2567,
            "content": "const response = await fetch(",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 2777,
            "content": "await fetch(`${supabaseUrl}/rest/v1/alertas_cambios_precios?procesada=eq.true&fecha_alerta=lt.${thir",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 2792,
            "content": "const response = await fetch(`${supabaseUrl}/rest/v1/alertas_cambios_precios`, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 2883,
            "content": "return await generarAlertasOptimizado(supabaseUrl, serviceRoleKey, corsHeaders, crypto.randomUUID(),",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 2891,
            "content": "return await obtenerEstadoScrapingOptimizado(supabaseUrl, serviceRoleKey, corsHeaders, crypto.random",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 2899,
            "content": "return await compararPreciosOptimizado(supabaseUrl, serviceRoleKey, corsHeaders, crypto.randomUUID()",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 3176,
            "content": "const testResponse = await fetch(`${supabaseUrl}/rest/v1/precios_proveedor?select=count&limit=1`, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          }
        ],
        "inefficient_queries": [
          {
            "line": 1555,
            "content": "const query = `${supabaseUrl}/rest/v1/precios_proveedor?select=*&fuente=eq.Maxiconsumo Necochea&acti",
            "issue": "SELECT * ineficiente",
            "impact": "HIGH"
          },
          {
            "line": 1590,
            "content": "const query = `${supabaseUrl}/rest/v1/productos?select=*&activo=eq.true&limit=${batchSize}&offset=${",
            "issue": "SELECT * ineficiente",
            "impact": "HIGH"
          },
          {
            "line": 2068,
            "content": "const query = `${supabaseUrl}/rest/v1/precios_historicos?select=*,productos(nombre,sku,activo)&fecha",
            "issue": "SELECT * ineficiente",
            "impact": "HIGH"
          },
          {
            "line": 2505,
            "content": "`${supabaseUrl}/rest/v1/estadisticas_scraping?select=*&order=created_at.desc&limit=1`,",
            "issue": "SELECT * ineficiente",
            "impact": "HIGH"
          },
          {
            "line": 2568,
            "content": "`${supabaseUrl}/rest/v1/configuracion_proveedor?select=*&nombre=eq.Maxiconsumo Necochea`,",
            "issue": "SELECT * ineficiente",
            "impact": "HIGH"
          }
        ],
        "missing_parallelization": [
          {
            "line": 411,
            "content": "await forceGarbageCollection();",
            "issue": "Loop con await secuencial, debería usar Promise.all",
            "impact": "CRITICAL"
          },
          {
            "line": 1470,
            "content": "const matchingResults = await performAdvancedMatching(",
            "issue": "Loop con await secuencial, debería usar Promise.all",
            "impact": "CRITICAL"
          },
          {
            "line": 1673,
            "content": "match = await performFuzzyMatching(productoProv, productosSistema);",
            "issue": "Loop con await secuencial, debería usar Promise.all",
            "impact": "CRITICAL"
          },
          {
            "line": 1991,
            "content": "const alertasDetectadas = await performAdvancedChangeDetection(",
            "issue": "Loop con await secuencial, debería usar Promise.all",
            "impact": "CRITICAL"
          }
        ],
        "rate_limiting_issues": [],
        "throughput_score": 0
      },
      "accuracy_analysis": {
        "error_handling": [
          {
            "line": 284,
            "content": "} catch (e) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 299,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 431,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 522,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 595,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 645,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 710,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 756,
            "content": ".catch(() => Math.random().toString(36).substring(2, 15));",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 828,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 919,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 962,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 1113,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 1202,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 1251,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 1325,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 1384,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 1536,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 1885,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 1934,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 2053,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 2102,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 2126,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 2375,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 2490,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 2830,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 3133,
            "content": "} catch (e) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 3187,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          }
        ],
        "retry_logic": [
          {
            "line": 77,
            "content": "requestMetrics: {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 95,
            "content": "requestDelays: {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 136,
            "content": "requestMetrics: { total: 0, successful: 0, failed: 0, averageResponseTime: 0 },",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 142,
            "content": "private requests: number[] = [];",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 144,
            "content": "private currentRate: number = 10; // requests per second",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 153,
            "content": "// Clean old requests",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 154,
            "content": "this.requests = this.requests.filter(time => now - time < windowSize);",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 156,
            "content": "if (this.requests.length >= this.currentRate) {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 163,
            "content": "this.requests.push(now);",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 180,
            "content": "'Access-Control-Allow-Headers': 'authorization, x-client-info, apikey, content-type, x-request-id',",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 190,
            "content": "const requestId = crypto.randomUUID();",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 195,
            "content": "requestId,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 250,
            "content": "requestId",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 261,
            "content": "response = await ejecutarScrapingCompleto(supabaseUrl, serviceRoleKey, sanitizedCategoria, corsHeade",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 264,
            "content": "response = await compararPreciosOptimizado(supabaseUrl, serviceRoleKey, corsHeaders, requestId, stru",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 267,
            "content": "response = await generarAlertasOptimizado(supabaseUrl, serviceRoleKey, corsHeaders, requestId, struc",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 270,
            "content": "response = await obtenerEstadoScrapingOptimizado(supabaseUrl, serviceRoleKey, corsHeaders, requestId",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 273,
            "content": "response = await getHealthCheck(supabaseUrl, serviceRoleKey, corsHeaders, requestId, structuredLog);",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 344,
            "content": "requestId: string,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 361,
            "content": "requests_exitosos: 0,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 362,
            "content": "requests_fallidos: 0",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 422,
            "content": "stats.requests_exitosos++;",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 436,
            "content": "stats.requests_fallidos++;",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 497,
            "content": "tasa_exito: Math.round((stats.requests_exitosos / Math.max(stats.requests_exitosos + stats.requests_",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 503,
            "content": "requestId,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 569,
            "content": "const captchaResponse = await fetch(captchaCheckUrl, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 592,
            "content": "response = await fetchWithAdvancedAntiDetection(urlCategoria, headers, categoriaLog);",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 668,
            "content": "* OPTIMIZACIÓN: Advanced anti-detection fetch",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 670,
            "content": "async function fetchWithAdvancedAntiDetection(url: string, headers: Record<string, string>, structur",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 671,
            "content": "const requestId = structuredLog.requestId || crypto.randomUUID();",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 675,
            "content": "const requestStartTime = Date.now();",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 677,
            "content": "const response = await fetch(url, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 680,
            "content": "'X-Request-ID': requestId,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 687,
            "content": "const responseTime = Date.now() - requestStartTime;",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 690,
            "content": "PERFORMANCE_METRICS.requestMetrics.total++;",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 692,
            "content": "PERFORMANCE_METRICS.requestMetrics.successful++;",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 694,
            "content": "PERFORMANCE_METRICS.requestMetrics.failed++;",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 697,
            "content": "PERFORMANCE_METRICS.requestMetrics.averageResponseTime =",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 698,
            "content": "(PERFORMANCE_METRICS.requestMetrics.averageResponseTime + responseTime) / 2;",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 705,
            "content": "requestId",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 740,
            "content": "* OPTIMIZACIÓN: Generate session ID for request tracking",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1085,
            "content": "async function fetchConReintentos(url: string, headers: Record<string, string>, maxReintentos: numbe",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1090,
            "content": "const response = await fetch(url, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1240,
            "content": "const response = await fetch(query, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1295,
            "content": "const response = await fetch(`${supabaseUrl}/rest/v1/precios_proveedor`, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1348,
            "content": "const response = await fetch(",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1421,
            "content": "requestId: string,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1438,
            "content": "requestId",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1444,
            "content": "// OPTIMIZACIÓN: Parallel data fetching",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1448,
            "content": "fetchProductosProveedorOptimizado(supabaseUrl, serviceRoleKey),",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1449,
            "content": "fetchProductosSistemaOptimizado(supabaseUrl, serviceRoleKey)",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1517,
            "content": "requestId,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1549,
            "content": "async function fetchProductosProveedorOptimizado(supabaseUrl: string, serviceRoleKey: string): Promi",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1557,
            "content": "const response = await fetch(query, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1565,
            "content": "throw new Error(`Error fetching provider products: ${response.statusText}`);",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1584,
            "content": "async function fetchProductosSistemaOptimizado(supabaseUrl: string, serviceRoleKey: string): Promise",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1592,
            "content": "const response = await fetch(query, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1600,
            "content": "throw new Error(`Error fetching system products: ${response.statusText}`);",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1844,
            "content": "await fetch(`${supabaseUrl}/rest/v1/comparacion_precios?fecha_comparacion=lt.${thirtyDaysAgo}`, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1859,
            "content": "const response = await fetch(`${supabaseUrl}/rest/v1/comparacion_precios`, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1925,
            "content": "await fetch(`${supabaseUrl}/rest/v1/comparacion_precios`, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1947,
            "content": "requestId: string,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1962,
            "content": "requestId",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1968,
            "content": "// OPTIMIZACIÓN: Parallel fetching of different data sources",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1970,
            "content": "fetchPreciosHistoricosOptimizado(supabaseUrl, serviceRoleKey),",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1971,
            "content": "fetchConfiguracionAlertas(supabaseUrl, serviceRoleKey),",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1972,
            "content": "fetchProductosActivos(supabaseUrl, serviceRoleKey)",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2034,
            "content": "requestId,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2066,
            "content": "async function fetchPreciosHistoricosOptimizado(supabaseUrl: string, serviceRoleKey: string): Promis",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2070,
            "content": "const response = await fetch(query, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2078,
            "content": "throw new Error(`Error fetching price history: ${response.statusText}`);",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2087,
            "content": "async function fetchConfiguracionAlertas(supabaseUrl: string, serviceRoleKey: string): Promise<any> ",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2091,
            "content": "const response = await fetch(query, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2103,
            "content": "console.warn('Error fetching alert config:', error.message);",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2112,
            "content": "async function fetchProductosActivos(supabaseUrl: string, serviceRoleKey: string): Promise<any[]> {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2116,
            "content": "const response = await fetch(query, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2127,
            "content": "console.warn('Error fetching active products:', error.message);",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2355,
            "content": "await fetch(`${supabaseUrl}/rest/v1/alertas_cambios_precios`, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2401,
            "content": "requestId: string,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2416,
            "content": "requestId",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2422,
            "content": "// OPTIMIZACIÓN: Parallel fetching of system metrics",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2424,
            "content": "fetchLatestStatistics(supabaseUrl, serviceRoleKey),",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2425,
            "content": "fetchTotalProductsCount(supabaseUrl, serviceRoleKey),",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2426,
            "content": "fetchComparisonsCount(supabaseUrl, serviceRoleKey),",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2427,
            "content": "fetchSystemConfiguration(supabaseUrl, serviceRoleKey),",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2428,
            "content": "fetchHealthMetrics()",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2471,
            "content": "requestId,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2503,
            "content": "async function fetchLatestStatistics(supabaseUrl: string, serviceRoleKey: string): Promise<any> {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2504,
            "content": "const response = await fetch(",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2524,
            "content": "async function fetchTotalProductsCount(supabaseUrl: string, serviceRoleKey: string): Promise<number>",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2525,
            "content": "const response = await fetch(",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2545,
            "content": "async function fetchComparisonsCount(supabaseUrl: string, serviceRoleKey: string): Promise<number> {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2546,
            "content": "const response = await fetch(",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2566,
            "content": "async function fetchSystemConfiguration(supabaseUrl: string, serviceRoleKey: string): Promise<any> {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2567,
            "content": "const response = await fetch(",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2587,
            "content": "async function fetchHealthMetrics(): Promise<any> {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2596,
            "content": "requests: { ...PERFORMANCE_METRICS.requestMetrics },",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2617,
            "content": "const totalRequests = healthMetrics.requests?.total || 0;",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2619,
            "content": "const successRate = healthMetrics.requests.successful / totalRequests;",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2777,
            "content": "await fetch(`${supabaseUrl}/rest/v1/alertas_cambios_precios?procesada=eq.true&fecha_alerta=lt.${thir",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2792,
            "content": "const response = await fetch(`${supabaseUrl}/rest/v1/alertas_cambios_precios`, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 3091,
            "content": "requestMetrics: { ...PERFORMANCE_METRICS.requestMetrics },",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 3103,
            "content": "'too many requests',",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 3117,
            "content": "requestId: structuredLog.requestId,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 3158,
            "content": "requestId: string,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 3176,
            "content": "const testResponse = await fetch(`${supabaseUrl}/rest/v1/precios_proveedor?select=count&limit=1`, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 3201,
            "content": "requestId",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          }
        ],
        "data_validation": [
          {
            "line": 6,
            "content": "* - Scraping inteligente de +40,000 productos con anti-detección avanzada",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 47,
            "content": "url_producto: string;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 51,
            "content": "metadata?: Record<string, any>;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 64,
            "content": "data: any;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 84,
            "content": "productos_processed: number;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 85,
            "content": "productos_successful: number;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 86,
            "content": "productos_failed: number;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 106,
            "content": "producto_id: string;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 107,
            "content": "nombre_producto: string;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 119,
            "content": "producto_id: string;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 120,
            "content": "nombre_producto: string;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 121,
            "content": "tipo_cambio: 'aumento' | 'disminucion' | 'nuevo_producto';",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 137,
            "content": "scrapingMetrics: { productos_processed: 0, productos_successful: 0, productos_failed: 0, timeElapsed",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 351,
            "content": "const productosExtraidos: ProductoMaxiconsumo[] = [];",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 355,
            "content": "productos_procesados: 0,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 356,
            "content": "productos_exitosos: 0,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 357,
            "content": "productos_con_error: 0,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 414,
            "content": "const productosCategoria = await scrapeCategoriaOptimizado(",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 420,
            "content": "productosExtraidos.push(...productosCategoria);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 421,
            "content": "stats.productos_exitosos += productosCategoria.length;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 428,
            "content": "productos: productosCategoria.length",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 435,
            "content": "stats.productos_con_error++;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 456,
            "content": "stats.productos_procesados = productosExtraidos.length + errores.length;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 461,
            "content": "console.log(JSON.stringify({ ...scrapingLog, event: 'SAVE_START', productos: productosExtraidos.leng",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 464,
            "content": "productosExtraidos,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 471,
            "content": "// OPTIMIZACIÓN: Dead letter queue para productos fallidos",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 472,
            "content": "if (productosExtraidos.length > 0) {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 473,
            "content": "await sendToDeadLetterQueue(productosExtraidos.filter(p => !p.sku), structuredLog);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 478,
            "content": "productosExtraidos,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 490,
            "content": "data: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 496,
            "content": "tiempo_por_producto: Math.round(stats.tiempo_ejecucion / Math.max(stats.productos_exitosos, 1)),",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 499,
            "content": "productos_extraidos: productosExtraidos.length,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 500,
            "content": "productos_guardados: guardados,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 512,
            "content": "productos: stats.productos_exitosos,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 544,
            "content": "const productos: ProductoMaxiconsumo[] = [];",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 618,
            "content": "const productosExtraidos = await extractProductosConOptimizacion(html, categoria, urlBase, categoria",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 621,
            "content": "const productosValidados = productosExtraidos.map(producto => {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 623,
            "content": "const content = `${producto.nombre}-${producto.precio_unitario}-${producto.stock_disponible}`;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 624,
            "content": "producto.hash_contenido = generateContentHash(content);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 625,
            "content": "producto.score_confiabilidad = calculateConfidenceScore(producto);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 626,
            "content": "producto.metadata = {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 632,
            "content": "return producto;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 638,
            "content": "productos: productosValidados.length,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 643,
            "content": "return productosValidados;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 653,
            "content": "// OPTIMIZACIÓN: Partial data recovery",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 654,
            "content": "if (productos.length > 0) {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 658,
            "content": "productos_salvados: productos.length",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 660,
            "content": "return productos;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 751,
            "content": "const data = encoder.encode(content);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 752,
            "content": "return crypto.subtle.digest('SHA-256', data)",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 760,
            "content": "* OPTIMIZACIÓN: Calculate confidence score for extracted data",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 762,
            "content": "function calculateConfidenceScore(producto: ProductoMaxiconsumo): number {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 765,
            "content": "// Boost score for complete data",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 766,
            "content": "if (producto.nombre && producto.nombre.length > 5) score += 10;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 767,
            "content": "if (producto.precio_unitario && producto.precio_unitario > 0) score += 15;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 768,
            "content": "if (producto.sku) score += 10;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 769,
            "content": "if (producto.codigo_barras) score += 5;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 770,
            "content": "if (producto.stock_disponible !== undefined) score += 5;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 772,
            "content": "// Penalize for suspicious data",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 773,
            "content": "if (producto.nombre.length > 200) score -= 10;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 774,
            "content": "if (producto.precio_unitario && (producto.precio_unitario < 1 || producto.precio_unitario > 100000))",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 783,
            "content": "const productos: ProductoMaxiconsumo[] = [];",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 791,
            "content": "/<article[^>]*class=\"[^\"]*product[^\"]*\"[^>]*>.*?<h[2-4][^>]*>([^<]+)<\\/h[2-4]>.*?price[\"'\\s]*:?\\s*[\"",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 801,
            "content": "while ((match = pattern.exec(html)) !== null && productos.length < 1000) { // Limit to prevent memor",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 808,
            "content": "if (nombre && precio > 0 && precio < 100000) { // Reasonable price range",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 809,
            "content": "const producto: ProductoMaxiconsumo = {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 815,
            "content": "url_producto: `${urlBase}producto/${encodeURIComponent(sku)}`,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 817,
            "content": "metadata: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 823,
            "content": "// OPTIMIZACIÓN: Additional data extraction",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 824,
            "content": "await enrichProductData(producto, html, match.index);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 826,
            "content": "productos.push(producto);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 839,
            "content": "if (productos.length > 10) break;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 842,
            "content": "return productos;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 857,
            "content": "* OPTIMIZACIÓN: Enrich product data with additional information",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 859,
            "content": "async function enrichProductData(producto: ProductoMaxiconsumo, html: string, position: number): Pro",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 867,
            "content": "// Extract promotional price",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 886,
            "content": "const productos: ProductoMaxiconsumo[] = [];",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 888,
            "content": "// Patrón para extraer productos (ajustar según estructura real del sitio)",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 889,
            "content": "const productoPattern = /<div[^>]*class=\"[^\"]*producto[^\"]*\"[^>]*>.*?<h3[^>]*>(.*?)<\\/h3>.*?<span[^>",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 892,
            "content": "while ((match = productoPattern.exec(html)) !== null) {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 900,
            "content": "const producto: ProductoMaxiconsumo = {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 906,
            "content": "url_producto: `${urlBase}producto/${sku}`,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 914,
            "content": "producto.codigo_barras = codigoMatch[1];",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 917,
            "content": "productos.push(producto);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 920,
            "content": "console.warn(`Error procesando producto:`, error.message);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 924,
            "content": "// Si no se encontraron productos con el patrón principal, usar patrón alternativo",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 925,
            "content": "if (productos.length === 0) {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 926,
            "content": "const productosAlternativos = extraerProductosPatronAlternativo(html, categoria, urlBase);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 927,
            "content": "productos.push(...productosAlternativos);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 930,
            "content": "return productos;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 937,
            "content": "const productos: ProductoMaxiconsumo[] = [];",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 940,
            "content": "const productoPattern = /<h[2-6][^>]*>(.*?)<\\/h[2-6]>.*?precio.*?(\\d+[\\.,]\\d+)/gs;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 943,
            "content": "while ((match = productoPattern.exec(html)) !== null) {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 952,
            "content": "productos.push({",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 958,
            "content": "url_producto: `${urlBase}buscar?q=${encodeURIComponent(nombre)}`,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 967,
            "content": "return productos;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1010,
            "content": "max_productos: 1000",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1015,
            "content": "max_productos: 500",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1020,
            "content": "max_productos: 300",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1025,
            "content": "max_productos: 200",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1030,
            "content": "max_productos: 200",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1035,
            "content": "max_productos: 150",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1040,
            "content": "max_productos: 100",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1045,
            "content": "max_productos: 150",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1050,
            "content": "max_productos: 100",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1130,
            "content": "productos: ProductoMaxiconsumo[],",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1136,
            "content": "const saveLog = { ...structuredLog, event: 'SAVE_START', productos: productos.length };",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1139,
            "content": "if (productos.length === 0) {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1147,
            "content": "for (let i = 0; i < productos.length; i += batchSize) {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1148,
            "content": "batches.push(productos.slice(i, i + batchSize));",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1156,
            "content": "const skus = productos.map(p => p.sku).filter(sku => sku);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1169,
            "content": "const productosNuevos = productos.filter(p => !existingSkus.has(p.sku));",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1170,
            "content": "const productosExistentes = productos.filter(p => existingSkus.has(p.sku));",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1175,
            "content": "nuevos: productosNuevos.length,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1176,
            "content": "existentes: productosExistentes.length",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1180,
            "content": "for (const batch of splitIntoBatches(productosNuevos, batchSize)) {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1186,
            "content": "for (const batch of splitIntoBatches(productosExistentes, batchSize)) {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1197,
            "content": "tasa_exito: Math.round((totalGuardados / productos.length) * 100)",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1248,
            "content": "const data = await response.json();",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1249,
            "content": "results.push(...data);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1262,
            "content": "async function batchInsertProducts(productos: ProductoMaxiconsumo[], supabaseUrl: string, serviceRol",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1263,
            "content": "if (productos.length === 0) return 0;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1266,
            "content": "// OPTIMIZACIÓN: Prepare batch insert data",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1267,
            "content": "const insertData = productos.map(producto => ({",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1268,
            "content": "sku: producto.sku,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1269,
            "content": "nombre: producto.nombre,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1270,
            "content": "marca: producto.marca,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1271,
            "content": "categoria: producto.categoria,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1272,
            "content": "precio_unitario: producto.precio_unitario,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1273,
            "content": "precio_promocional: producto.precio_promocional,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1274,
            "content": "stock_disponible: producto.stock_disponible,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1275,
            "content": "stock_nivel_minimo: producto.stock_nivel_minimo,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1276,
            "content": "codigo_barras: producto.codigo_barras,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1277,
            "content": "url_producto: producto.url_producto,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1278,
            "content": "imagen_url: producto.imagen_url,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1279,
            "content": "descripcion: producto.descripcion,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1280,
            "content": "hash_contenido: producto.hash_contenido,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1281,
            "content": "score_confiabilidad: producto.score_confiabilidad,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1282,
            "content": "ultima_actualizacion: producto.ultima_actualizacion,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1285,
            "content": "metadata: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1286,
            "content": "extracted_at: producto.metadata?.extracted_at,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1287,
            "content": "categoria: producto.categoria,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1288,
            "content": "captcha_encountered: producto.metadata?.captcha_encountered,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1289,
            "content": "retry_count: producto.metadata?.retry_count,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1290,
            "content": "extraction_pattern: producto.metadata?.extracted_by_pattern,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1291,
            "content": "confidence_score: producto.score_confiabilidad",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1312,
            "content": "productos: productos.length",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1338,
            "content": "async function batchUpdateProducts(productos: ProductoMaxiconsumo[], supabaseUrl: string, serviceRol",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1343,
            "content": "const batches = splitIntoBatches(productos, updateBatchSize);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1346,
            "content": "for (const producto of batch) {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1349,
            "content": "`${supabaseUrl}/rest/v1/precios_proveedor?sku=eq.${encodeURIComponent(producto.sku)}`,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1359,
            "content": "nombre: producto.nombre,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1360,
            "content": "marca: producto.marca,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1361,
            "content": "categoria: producto.categoria,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1362,
            "content": "precio_unitario: producto.precio_unitario,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1363,
            "content": "precio_promocional: producto.precio_promocional,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1364,
            "content": "stock_disponible: producto.stock_disponible,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1365,
            "content": "stock_nivel_minimo: producto.stock_nivel_minimo,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1366,
            "content": "url_producto: producto.url_producto,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1367,
            "content": "imagen_url: producto.imagen_url,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1368,
            "content": "descripcion: producto.descripcion,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1369,
            "content": "hash_contenido: producto.hash_contenido,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1370,
            "content": "score_confiabilidad: producto.score_confiabilidad,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1371,
            "content": "ultima_actualizacion: producto.ultima_actualizacion,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1373,
            "content": "metadata: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1374,
            "content": "...producto.metadata,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1385,
            "content": "console.warn(`Error updating product ${producto.sku}:`, error.message);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1389,
            "content": "// Small delay between update batches to avoid overwhelming the database",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1397,
            "content": "productos: productos.length",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1431,
            "content": "const cacheKey = 'price_comparison:latest';",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1444,
            "content": "// OPTIMIZACIÓN: Parallel data fetching",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1447,
            "content": "const [productosProveedor, productosSistema] = await Promise.allSettled([",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1452,
            "content": "if (productosProveedor.status === 'rejected') {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1453,
            "content": "throw new Error(`Error obteniendo productos proveedor: ${productosProveedor.reason.message}`);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1455,
            "content": "if (productosSistema.status === 'rejected') {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1456,
            "content": "throw new Error(`Error obteniendo productos sistema: ${productosSistema.reason.message}`);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1459,
            "content": "const productosProveedorData = productosProveedor.value;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1460,
            "content": "const productosSistemaData = productosSistema.value;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1465,
            "content": "proveedor_count: productosProveedorData.length,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1466,
            "content": "sistema_count: productosSistemaData.length",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1471,
            "content": "productosProveedorData,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1472,
            "content": "productosSistemaData,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1512,
            "content": "data: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1547,
            "content": "* OPTIMIZACIÓN: Fetch productos proveedor con paginación",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1550,
            "content": "const productos = [];",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1571,
            "content": "productos.push(...batch);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1575,
            "content": "if (productos.length > 10000) break;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1578,
            "content": "return productos;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1582,
            "content": "* OPTIMIZACIÓN: Fetch productos sistema con cache y paginación",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1585,
            "content": "const productos = [];",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1590,
            "content": "const query = `${supabaseUrl}/rest/v1/productos?select=*&activo=eq.true&limit=${batchSize}&offset=${",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1606,
            "content": "productos.push(...batch);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1610,
            "content": "if (productos.length > 10000) break;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1613,
            "content": "return productos;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1619,
            "content": "async function performAdvancedMatching(productosProveedor: any[], productosSistema: any[], structure",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1627,
            "content": "productosSistema.forEach(p => {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1640,
            "content": "for (const productoProv of productosProveedor) {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1646,
            "content": "if (productoProv.sku && sistemaSkuIndex.has(productoProv.sku)) {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1647,
            "content": "match = sistemaSkuIndex.get(productoProv.sku);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1653,
            "content": "else if (productoProv.codigo_barras && sistemaBarcodeIndex.has(productoProv.codigo_barras)) {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1654,
            "content": "match = sistemaBarcodeIndex.get(productoProv.codigo_barras);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1661,
            "content": "const normalizedProvName = normalizeProductName(productoProv.nombre);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1667,
            "content": "confidence = calculateNameSimilarity(productoProv.nombre, match.nombre);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1673,
            "content": "match = await performFuzzyMatching(productoProv, productosSistema);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1682,
            "content": "producto_proveedor: productoProv,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1683,
            "content": "producto_sistema: match,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1737,
            "content": "async function performFuzzyMatching(productoProv: any, productosSistema: any[]): Promise<any | null>",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1738,
            "content": "const normalizedProvName = normalizeProductName(productoProv.nombre);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1743,
            "content": "for (let i = 0; i < Math.min(100, productosSistema.length); i++) {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1744,
            "content": "const productoSistema = productosSistema[i];",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1745,
            "content": "if (!productoSistema.nombre) continue;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1747,
            "content": "const score = calculateNameSimilarity(productoProv.nombre, productoSistema.nombre);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1750,
            "content": "bestMatch = { ...productoSistema, fuzzy_score: score };",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1763,
            "content": "// Boost confidence for complete data",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1764,
            "content": "if (match.producto_proveedor.codigo_barras && match.producto_sistema.codigo_barras) {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1767,
            "content": "if (match.producto_proveedor.marca && match.producto_sistema.marca) {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1768,
            "content": "if (normalizeProductName(match.producto_proveedor.marca) === normalizeProductName(match.producto_sis",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1773,
            "content": "// Adjust based on price similarity",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1778,
            "content": "const priceDiff = Math.abs(precioProv - precioSist) / Math.max(precioProv, precioSist);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1779,
            "content": "if (priceDiff < 0.1) { // Less than 10% difference",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1798,
            "content": "producto_id: match.producto_sistema.id,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1799,
            "content": "nombre_producto: match.producto_sistema.nombre,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1960,
            "content": "...cached.data,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1968,
            "content": "// OPTIMIZACIÓN: Parallel fetching of different data sources",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1969,
            "content": "const [historicoPrecios, configuracionAlertas, productosActivos] = await Promise.allSettled([",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1981,
            "content": "const productosActivosData = productosActivos.status === 'fulfilled' ? productosActivos.value : [];",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1987,
            "content": "productos_activos: productosActivosData.length",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1994,
            "content": "productosActivosData,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2017,
            "content": "nuevos_productos: alertasConSeveridad.filter(a => a.tipo_cambio === 'nuevo_producto').length",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2019,
            "content": "productos_afectados: new Set(alertasConSeveridad.map(a => a.producto_id)).size,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2027,
            "content": "data: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2040,
            "content": "addToCache(cacheKey, { data: resultado, timestamp: Date.now() }, 300000); // 5 minutes",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2068,
            "content": "const query = `${supabaseUrl}/rest/v1/precios_historicos?select=*,productos(nombre,sku,activo)&fecha",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2078,
            "content": "throw new Error(`Error fetching price history: ${response.statusText}`);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2099,
            "content": "const data = await response.json();",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2100,
            "content": "return data[0]?.configuraciones || { umbral_cambio: 15 };",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2110,
            "content": "* OPTIMIZACIÓN: Fetch productos activos",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2113,
            "content": "const query = `${supabaseUrl}/rest/v1/productos?select=id,nombre,sku&activo=eq.true&limit=1000`;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2136,
            "content": "async function performAdvancedChangeDetection(historico: any[], config: any, productosActivos: any[]",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2143,
            "content": "for (const item of historico) {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2144,
            "content": "const productoId = item.producto_id;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2145,
            "content": "if (!cambiosPorProducto.has(productoId)) {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2146,
            "content": "cambiosPorProducto.set(productoId, []);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2148,
            "content": "cambiosPorProducto.get(productoId).push(item);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2151,
            "content": "// OPTIMIZACIÓN: Analyze each product's price trends",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2152,
            "content": "for (const [productoId, cambios] of cambiosPorProducto.entries()) {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2167,
            "content": "const umbralAdaptativo = calcularUmbralAdaptativo(cambioActual.productos, config);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2171,
            "content": "producto_id: productoId,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2172,
            "content": "nombre_producto: cambioActual.productos?.nombre || 'Producto desconocido',",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2181,
            "content": "metadata: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2194,
            "content": "const productosConPrecio = new Set(historico.map(h => h.producto_id));",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2195,
            "content": "for (const producto of productosActivos) {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2196,
            "content": "if (!productosConPrecio.has(producto.id)) {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2199,
            "content": "producto_id: producto.id,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2200,
            "content": "nombre_producto: producto.nombre,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2201,
            "content": "tipo_cambio: 'nuevo_producto',",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2203,
            "content": "mensaje: 'Nuevo producto detectado en el sistema',",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2205,
            "content": "accion_recomendada: 'Revisar y categorizar nuevo producto'",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2222,
            "content": "function calcularUmbralAdaptativo(producto: any, config: any): number {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2226,
            "content": "const categoria = producto?.categoria?.toLowerCase();",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2231,
            "content": "umbral *= 1.2; // Less sensitive for household items",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2264,
            "content": "* OPTIMIZACIÓN: Determine price trend",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2292,
            "content": "// Boost confidence for consistent data",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2312,
            "content": "* OPTIMIZACIÓN: Check if changes have complete data",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2318,
            "content": "cambio.productos?.nombre",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2363,
            "content": "producto_id: alerta.producto_id,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2385,
            "content": "productosExtraidos: ProductoMaxiconsumo[],",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2390,
            "content": "console.log(`📧 Simulando envío de alertas para ${productosExtraidos.length} productos...`);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2391,
            "content": "return productosExtraidos.length;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2445,
            "content": "data: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2449,
            "content": "productos_maxiconsumo: totalProductosData,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2483,
            "content": "productos: totalProductosData",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2515,
            "content": "const data = await response.json();",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2516,
            "content": "return data[0] || null;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2536,
            "content": "const data = await response.json();",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2537,
            "content": "return data[0]?.count || 0;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2557,
            "content": "const data = await response.json();",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2558,
            "content": "return data[0]?.count || 0;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2578,
            "content": "const data = await response.json();",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2579,
            "content": "return data[0] || {};",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2710,
            "content": "const key = `${alerta.producto_id}_${Math.floor(new Date(alerta.fecha_alerta).getTime() / (1000 * 60",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2747,
            "content": "// Adjust based on product price range",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2757,
            "content": "h.producto_id === alerta.producto_id &&",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2800,
            "content": "producto_id: alerta.producto_id,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2810,
            "content": "metadata: alerta.metadata",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2842,
            "content": "productosExtraidos: ProductoMaxiconsumo[],",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2851,
            "content": "productos: productosExtraidos.length",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2864,
            "content": "return productosExtraidos.length;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2869,
            "content": "productosExtraidos: ProductoMaxiconsumo[],",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2873,
            "content": "console.log(`📧 Simulando envío de alertas para ${productosExtraidos.length} productos...`);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2874,
            "content": "return productosExtraidos.length;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2932,
            "content": "return entry.data;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2935,
            "content": "function addToCache(key: string, data: any, ttl: number): void {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2945,
            "content": "data,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3113,
            "content": "async function sendToDeadLetterQueue(items: any[], structuredLog: any, error?: Error): Promise<void>",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3118,
            "content": "items: items.slice(0, 10), // Limit to prevent too much data",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3165,
            "content": "database: 'unknown',",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3175,
            "content": "// Test database connectivity",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3183,
            "content": "health.services.database = testResponse.ok ? 'healthy' : 'unhealthy';",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3188,
            "content": "health.services.database = 'unhealthy';",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          }
        ],
        "selector_robustness": [
          {
            "line": 794,
            "content": "/<h[2-4][^>]*>([^<]+)<\\/h[2-4]>.*?\\$([0-9]+(?:[.,][0-9]{2})?)/gs",
            "issue": "Selector sin fallback",
            "impact": "HIGH"
          }
        ],
        "accuracy_score": 0
      },
      "caching_opportunities": [
        {
          "line": 614,
          "type": "COMPUTATION_CACHING",
          "content": "// OPTIMIZACIÓN: Streaming response processing for memory efficiency",
          "opportunity": "Cache resultados de computaciones costosas",
          "impact": "MEDIUM",
          "estimated_improvement": "40% reduction en CPU usage"
        },
        {
          "line": 1144,
          "type": "COMPUTATION_CACHING",
          "content": "// OPTIMIZACIÓN: Batch processing para mejor performance",
          "opportunity": "Cache resultados de computaciones costosas",
          "impact": "MEDIUM",
          "estimated_improvement": "40% reduction en CPU usage"
        },
        {
          "line": 1590,
          "type": "API_CACHING",
          "content": "const query = `${supabaseUrl}/rest/v1/productos?select=*&activo=eq.true&limit=${batchSize}&offset=${",
          "opportunity": "Cache API calls de datos estáticos",
          "impact": "HIGH",
          "estimated_improvement": "60% reduction en DB calls"
        },
        {
          "line": 2068,
          "type": "API_CACHING",
          "content": "const query = `${supabaseUrl}/rest/v1/precios_historicos?select=*,productos(nombre,sku,activo)&fecha",
          "opportunity": "Cache API calls de datos estáticos",
          "impact": "HIGH",
          "estimated_improvement": "60% reduction en DB calls"
        },
        {
          "line": 2088,
          "type": "API_CACHING",
          "content": "const query = `${supabaseUrl}/rest/v1/configuracion_proveedor?select=configuraciones&nombre=eq.Maxic",
          "opportunity": "Cache API calls de datos estáticos",
          "impact": "HIGH",
          "estimated_improvement": "60% reduction en DB calls"
        },
        {
          "line": 2103,
          "type": "API_CACHING",
          "content": "console.warn('Error fetching alert config:', error.message);",
          "opportunity": "Cache API calls de datos estáticos",
          "impact": "HIGH",
          "estimated_improvement": "60% reduction en DB calls"
        },
        {
          "line": 2113,
          "type": "API_CACHING",
          "content": "const query = `${supabaseUrl}/rest/v1/productos?select=id,nombre,sku&activo=eq.true&limit=1000`;",
          "opportunity": "Cache API calls de datos estáticos",
          "impact": "HIGH",
          "estimated_improvement": "60% reduction en DB calls"
        }
      ],
      "overall_performance_score": 0.0
    },
    "/workspace/supabase/functions/api-proveedor/index.ts": {
      "file_path": "/workspace/supabase/functions/api-proveedor/index.ts",
      "lines": 3549,
      "size_kb": 126.27734375,
      "memory_analysis": {
        "large_arrays": [
          {
            "line": 118,
            "content": "const pathSegments = url.pathname.split('/').filter(segment => segment.length > 0);",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 548,
            "content": "productos_con_stock: productos.filter((p: any) => p.stock_disponible > 0).length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 549,
            "content": "marcas_unicas: [...new Set(productos.map((p: any) => p.marca).filter(Boolean))].length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 927,
            "content": "criticas: alertas.filter((a: any) => a.severidad === 'critica').length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 928,
            "content": "altas: alertas.filter((a: any) => a.severidad === 'alta').length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 929,
            "content": "medias: alertas.filter((a: any) => a.severidad === 'media').length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 930,
            "content": "bajas: alertas.filter((a: any) => a.severidad === 'baja').length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 931,
            "content": "aumentos: alertas.filter((a: any) => a.tipo_cambio === 'aumento').length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 932,
            "content": "disminuciones: alertas.filter((a: any) => a.tipo_cambio === 'disminucion').length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 933,
            "content": "nuevos_productos: alertas.filter((a: any) => a.tipo_cambio === 'nuevo_producto').length",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 1280,
            "content": "productos_con_stock: productosFinales.filter((p: any) => p.stock_disponible > 0).length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 1281,
            "content": "marcas_unicas: [...new Set(productosFinales.map((p: any) => p.marca).filter(Boolean))].length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 1287,
            "content": "promedio: productosFinales.reduce((sum: number, p: any) => sum + p.precio_actual, 0) / productosFina",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 1820,
            "content": "criticas: alertasFinales.filter((a: any) => a.severidad === 'critica').length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 1821,
            "content": "altas: alertasFinales.filter((a: any) => a.severidad === 'alta').length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 1822,
            "content": "medias: alertasFinales.filter((a: any) => a.severidad === 'media').length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 1823,
            "content": "bajas: alertasFinales.filter((a: any) => a.severidad === 'baja').length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 1824,
            "content": "aumentos: alertasFinales.filter((a: any) => a.tipo_cambio === 'aumento').length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 1825,
            "content": "disminuciones: alertasFinales.filter((a: any) => a.tipo_cambio === 'disminucion').length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 1826,
            "content": "nuevos_productos: alertasFinales.filter((a: any) => a.tipo_cambio === 'nuevo_producto').length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 1827,
            "content": "promedio_impacto: alertasFinales.reduce((sum: number, a: any) => sum + (a.impacto_estimado || 0), 0)",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 1828,
            "content": "alertas_requieren_accion: alertasFinales.filter((a: any) => a.action_required).length",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 2265,
            "content": "const ejecucionesExitosas = estadisticas.filter(stat => stat.status === 'exitoso').length;",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 2343,
            "content": "precio_promedio: precios.length > 0 ? precios.reduce((a, b) => a + b, 0) / precios.length : 0,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 2347,
            "content": "productos_con_stock: data.filter((item: any) => item.stock_disponible > 0).length",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 2762,
            "content": "const ejecucionesExitosas = estadisticas.filter(stat => stat.status === 'exitoso').length;",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 2805,
            "content": "tasa_exito_promedio: (stats.filter(s => s.status === 'exitoso').length / stats.length) * 100,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 2806,
            "content": "tiempo_promedio: stats.reduce((sum, s) => sum + (s.tiempo_ejecucion_ms || 0), 0) / stats.length",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 2816,
            "content": "estadisticas.filter(s => s.status === 'exitoso').length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 2817,
            "content": "failure_rate: (estadisticas.filter(s => s.status !== 'exitoso').length / estadisticas.length) * 100,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 3043,
            "content": "marcas: [...new Set(productos.map((p: any) => p.marca).filter(Boolean))].length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 3044,
            "content": "categorias: [...new Set(productos.map((p: any) => p.categoria).filter(Boolean))].length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 3048,
            "content": "promedio: productos.reduce((sum: number, p: any) => sum + p.precio_actual, 0) / productos.length",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 3205,
            "content": "average_score: scores.reduce((a, b) => a + b, 0) / scores.length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 3206,
            "content": "high_risk_count: scores.filter(s => s > 70).length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 3208,
            "content": "low: scores.filter(s => s < 30).length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 3209,
            "content": "medium: scores.filter(s => s >= 30 && s < 70).length,",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 3210,
            "content": "high: scores.filter(s => s >= 70).length",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 3295,
            "content": "const criticalCount = alertas.filter(a => a.severidad === 'critica').length;",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 3402,
            "content": "valor_promedio: oportunidadesCat.reduce((sum, o) => sum + o.diferencia_absoluta, 0) / oportunidadesC",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 3438,
            "content": "const avgProducts = estadisticas.reduce((sum, s) => sum + (s.productos_encontrados || 0), 0) / estad",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 3454,
            "content": "const successful = estadisticas.filter(s => s.status === 'exitoso').length;",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 3459,
            "content": "const avgProducts = estadisticas.reduce((sum, s) => sum + (s.productos_encontrados || 0), 0) / Math.",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 3460,
            "content": "const avgTime = estadisticas.reduce((sum, s) => sum + (s.tiempo_ejecucion_ms || 0), 0) / Math.max(es",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 3487,
            "content": "const avg = products.reduce((a, b) => a + b, 0) / products.length;",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 3488,
            "content": "const variance = products.reduce((sum, val) => sum + Math.pow(val - avg, 2), 0) / products.length;",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          },
          {
            "line": 3507,
            "content": "const avgSuccessRate = recentStats.filter(s => s.status === 'exitoso').length / recentStats.length;",
            "issue": "Operación en array grande sin paginación",
            "impact": "HIGH"
          }
        ],
        "string_concatenations": [],
        "closures": [
          {
            "line": 2840,
            "content": "await new Promise(resolve => setTimeout(resolve, delay));",
            "issue": "Closure potencial memory leak",
            "impact": "HIGH"
          },
          {
            "line": 2849,
            "content": "const timeoutId = setTimeout(() => controller.abort(), timeoutMs);",
            "issue": "Closure potencial memory leak",
            "impact": "HIGH"
          }
        ],
        "memory_leaks": [
          {
            "line": 211,
            "content": "let response: Response;",
            "issue": "Variable HTTP no const, posible memory leak",
            "impact": "MEDIUM"
          }
        ],
        "inefficient_loops": [
          {
            "line": 3133,
            "content": "for (let i = 0; i < configString.length; i++) {",
            "issue": "Loop accede .length en cada iteración",
            "impact": "MEDIUM"
          }
        ],
        "memory_score": 0
      },
      "throughput_analysis": {
        "synchronous_operations": [],
        "blocking_io": [
          {
            "line": 217,
            "content": "response = await getPreciosActualesOptimizado(supabaseUrl, serviceRoleKey, url, corsHeaders, isAuthe",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 220,
            "content": "response = await getProductosDisponiblesOptimizado(supabaseUrl, serviceRoleKey, url, corsHeaders, is",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 223,
            "content": "response = await getComparacionConSistemaOptimizado(supabaseUrl, serviceRoleKey, url, corsHeaders, i",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 229,
            "content": "response = await triggerSincronizacionOptimizado(supabaseUrl, serviceRoleKey, url, corsHeaders, isAu",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 232,
            "content": "response = await getEstadoSistemaOptimizado(supabaseUrl, serviceRoleKey, url, corsHeaders, requestLo",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 235,
            "content": "response = await getAlertasActivasOptimizado(supabaseUrl, serviceRoleKey, url, corsHeaders, isAuthen",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 238,
            "content": "response = await getEstadisticasScrapingOptimizado(supabaseUrl, serviceRoleKey, url, corsHeaders, is",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 241,
            "content": "response = await getConfiguracionProveedorOptimizado(supabaseUrl, serviceRoleKey, url, corsHeaders, ",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 244,
            "content": "response = await getHealthCheckOptimizado(supabaseUrl, serviceRoleKey, corsHeaders, requestLog);",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 420,
            "content": "const response = await fetch(query, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 439,
            "content": "const totalResponse = await fetch(totalQuery, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 526,
            "content": "const response = await fetch(query, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 540,
            "content": "const categoriasStats = await obtenerEstadisticasCategorias(supabaseUrl, serviceRoleKey);",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 617,
            "content": "const response = await fetch(query, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 690,
            "content": "const response = await fetch(scrapingUrl, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 715,
            "content": "const comparacionResponse = await fetch(comparacionUrl, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 767,
            "content": "const estadisticasResponse = await fetch(",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 784,
            "content": "const productosTotalesResponse = await fetch(",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 801,
            "content": "const oportunidadesResponse = await fetch(",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 818,
            "content": "const configResponse = await fetch(",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 911,
            "content": "const response = await fetch(query, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 986,
            "content": "const response = await fetch(query, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 1054,
            "content": "const response = await fetch(",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 1361,
            "content": "const response = await fetch(query, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 1493,
            "content": "const scrapingResponse = await fetchWithRetry(scrapingUrl, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 1517,
            "content": "const comparacionResponse = await fetchWithRetry(comparacionUrl, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 1775,
            "content": "const response = await fetch(query, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 1903,
            "content": "const response = await fetch(query, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 2002,
            "content": "const response = await fetch(",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 2190,
            "content": "const response = await fetch(",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 2438,
            "content": "const response = await fetch(`${supabaseUrl}/rest/v1/precios_proveedor?select=count&limit=1`, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 2456,
            "content": "const response = await fetch(`${supabaseUrl}/functions/v1/scraper-maxiconsumo/health`, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 2830,
            "content": "const response = await fetch(url, options);",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 2852,
            "content": "const response = await fetch(url, {",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 3005,
            "content": "const response = await fetch(",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          },
          {
            "line": 3033,
            "content": "const response = await fetch(",
            "issue": "I/O operation no paralellizada",
            "impact": "HIGH"
          }
        ],
        "inefficient_queries": [
          {
            "line": 412,
            "content": "let query = `${supabaseUrl}/rest/v1/precios_proveedor?select=*&fuente=eq.Maxiconsumo Necochea&activo",
            "issue": "SELECT * ineficiente",
            "impact": "HIGH"
          },
          {
            "line": 498,
            "content": "let query = `${supabaseUrl}/rest/v1/precios_proveedor?select=*&fuente=eq.Maxiconsumo Necochea&activo",
            "issue": "SELECT * ineficiente",
            "impact": "HIGH"
          },
          {
            "line": 591,
            "content": "let query = `${supabaseUrl}/rest/v1/vista_oportunidades_ahorro?select=*`;",
            "issue": "SELECT * ineficiente",
            "impact": "HIGH"
          },
          {
            "line": 768,
            "content": "`${supabaseUrl}/rest/v1/estadisticas_scraping?select=*&order=created_at.desc&limit=1`,",
            "issue": "SELECT * ineficiente",
            "impact": "HIGH"
          },
          {
            "line": 819,
            "content": "`${supabaseUrl}/rest/v1/configuracion_proveedor?select=*&nombre=eq.Maxiconsumo Necochea`,",
            "issue": "SELECT * ineficiente",
            "impact": "HIGH"
          },
          {
            "line": 893,
            "content": "let query = `${supabaseUrl}/rest/v1/vista_alertas_activas?select=*`;",
            "issue": "SELECT * ineficiente",
            "impact": "HIGH"
          },
          {
            "line": 980,
            "content": "let query = `${supabaseUrl}/rest/v1/estadisticas_scraping?select=*&created_at=gte.${fechaInicio.toIS",
            "issue": "SELECT * ineficiente",
            "impact": "HIGH"
          },
          {
            "line": 1055,
            "content": "`${supabaseUrl}/rest/v1/configuracion_proveedor?select=*&nombre=eq.Maxiconsumo Necochea`,",
            "issue": "SELECT * ineficiente",
            "impact": "HIGH"
          },
          {
            "line": 1239,
            "content": "const query = `${supabaseUrl}/rest/v1/precios_proveedor?select=*&fuente=eq.Maxiconsumo Necochea&acti",
            "issue": "SELECT * ineficiente",
            "impact": "HIGH"
          },
          {
            "line": 1611,
            "content": "`${supabaseUrl}/rest/v1/estadisticas_scraping?select=*&order=created_at.desc&limit=1`,",
            "issue": "SELECT * ineficiente",
            "impact": "HIGH"
          },
          {
            "line": 1629,
            "content": "`${supabaseUrl}/rest/v1/configuracion_proveedor?select=*&nombre=eq.Maxiconsumo Necochea`,",
            "issue": "SELECT * ineficiente",
            "impact": "HIGH"
          },
          {
            "line": 2003,
            "content": "`${supabaseUrl}/rest/v1/configuracion_proveedor?select=*&nombre=eq.Maxiconsumo Necochea`,",
            "issue": "SELECT * ineficiente",
            "impact": "HIGH"
          },
          {
            "line": 2299,
            "content": "let query = `${supabaseUrl}/rest/v1/precios_proveedor?select=*&fuente=eq.Maxiconsumo Necochea&activo",
            "issue": "SELECT * ineficiente",
            "impact": "HIGH"
          },
          {
            "line": 2386,
            "content": "let query = `${Deno.env.get('SUPABASE_URL')}/rest/v1/vista_oportunidades_ahorro?select=*`;",
            "issue": "SELECT * ineficiente",
            "impact": "HIGH"
          },
          {
            "line": 2404,
            "content": "let query = `${Deno.env.get('SUPABASE_URL')}/rest/v1/vista_alertas_activas?select=*`;",
            "issue": "SELECT * ineficiente",
            "impact": "HIGH"
          },
          {
            "line": 2424,
            "content": "let query = `${Deno.env.get('SUPABASE_URL')}/rest/v1/estadisticas_scraping?select=*&created_at=gte.$",
            "issue": "SELECT * ineficiente",
            "impact": "HIGH"
          }
        ],
        "missing_parallelization": [],
        "rate_limiting_issues": [],
        "throughput_score": 0
      },
      "accuracy_analysis": {
        "error_handling": [
          {
            "line": 249,
            "content": "} catch (endpointError) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 274,
            "content": "} catch (e) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 292,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 472,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 566,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 651,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 726,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 748,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 868,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 954,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 1021,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 1088,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 1198,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 1323,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 1440,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 1533,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 1582,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 1737,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 1863,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 1977,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 2066,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 2159,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 2216,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 2449,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 2465,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 2834,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 2858,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 3025,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          },
          {
            "line": 3051,
            "content": "} catch (error) {",
            "issue": "Error handling débil, solo console.log",
            "impact": "HIGH"
          }
        ],
        "retry_logic": [
          {
            "line": 47,
            "content": "private userLimits = new Map<string, { requests: number[]; limit: number; window: number }>();",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 54,
            "content": "this.userLimits.set(userId, { requests: [], limit: 100, window: windowMs });",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 59,
            "content": "// Clean old requests",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 60,
            "content": "userLimit.requests = userLimit.requests.filter(time => now - time < userLimit.window);",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 62,
            "content": "if (userLimit.requests.length >= userLimit.limit) {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 66,
            "content": "userLimit.requests.push(now);",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 77,
            "content": "'Access-Control-Allow-Headers': 'authorization, x-client-info, apikey, content-type, x-request-id, x",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 88,
            "content": "const requestId = crypto.randomUUID();",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 93,
            "content": "const requestLog = {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 94,
            "content": "requestId,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 103,
            "content": "console.log(JSON.stringify({ ...requestLog, event: 'OPTIONS_REQUEST' }));",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 146,
            "content": "console.warn(JSON.stringify({ ...requestLog, event: 'RATE_LIMITED', endpoint: sanitizedEndpoint }));",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 172,
            "content": "requestId",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 181,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 195,
            "content": "console.log(JSON.stringify({ ...requestLog, event: 'CACHE_HIT', cacheKey }));",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 203,
            "content": "requestId,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 217,
            "content": "response = await getPreciosActualesOptimizado(supabaseUrl, serviceRoleKey, url, corsHeaders, isAuthe",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 220,
            "content": "response = await getProductosDisponiblesOptimizado(supabaseUrl, serviceRoleKey, url, corsHeaders, is",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 223,
            "content": "response = await getComparacionConSistemaOptimizado(supabaseUrl, serviceRoleKey, url, corsHeaders, i",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 229,
            "content": "response = await triggerSincronizacionOptimizado(supabaseUrl, serviceRoleKey, url, corsHeaders, isAu",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 232,
            "content": "response = await getEstadoSistemaOptimizado(supabaseUrl, serviceRoleKey, url, corsHeaders, requestLo",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 235,
            "content": "response = await getAlertasActivasOptimizado(supabaseUrl, serviceRoleKey, url, corsHeaders, isAuthen",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 238,
            "content": "response = await getEstadisticasScrapingOptimizado(supabaseUrl, serviceRoleKey, url, corsHeaders, is",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 241,
            "content": "response = await getConfiguracionProveedorOptimizado(supabaseUrl, serviceRoleKey, url, corsHeaders, ",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 244,
            "content": "response = await getHealthCheckOptimizado(supabaseUrl, serviceRoleKey, corsHeaders, requestLog);",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 251,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 283,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 295,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 420,
            "content": "const response = await fetch(query, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 439,
            "content": "const totalResponse = await fetch(totalQuery, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 526,
            "content": "const response = await fetch(query, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 617,
            "content": "const response = await fetch(query, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 690,
            "content": "const response = await fetch(scrapingUrl, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 715,
            "content": "const comparacionResponse = await fetch(comparacionUrl, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 767,
            "content": "const estadisticasResponse = await fetch(",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 784,
            "content": "const productosTotalesResponse = await fetch(",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 801,
            "content": "const oportunidadesResponse = await fetch(",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 818,
            "content": "const configResponse = await fetch(",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 911,
            "content": "const response = await fetch(query, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 986,
            "content": "const response = await fetch(query, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1054,
            "content": "const response = await fetch(",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1107,
            "content": "requestLog: any",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1114,
            "content": "console.log(JSON.stringify({ ...requestLog, event: 'PRECIOS_REQUEST', categoria, limite, offset }));",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1182,
            "content": "tiempo_procesamiento: Date.now() - new Date(requestLog.timestamp).getTime(),",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1188,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1200,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1219,
            "content": "requestLog: any",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1229,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1243,
            "content": "fetch(query, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1305,
            "content": "tiempo_respuesta: Date.now() - new Date(requestLog.timestamp).getTime(),",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1313,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1325,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1343,
            "content": "requestLog: any",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1352,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1361,
            "content": "const response = await fetch(query, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1430,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1442,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1460,
            "content": "requestLog: any",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1467,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1489,
            "content": "request_id: requestLog.requestId,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1498,
            "content": "'X-Request-ID': requestLog.requestId",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1500,
            "content": "body: JSON.stringify(requestBody)",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1522,
            "content": "'X-Request-ID': requestLog.requestId",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1525,
            "content": "request_id: requestLog.requestId,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1535,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1544,
            "content": "duracion_total: Date.now() - new Date(requestLog.timestamp).getTime(),",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1564,
            "content": "request_id: requestLog.requestId",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1572,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1584,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1602,
            "content": "requestLog: any",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1604,
            "content": "console.log(JSON.stringify({ ...requestLog, event: 'STATUS_REQUEST' }));",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1610,
            "content": "fetchWithTimeout(",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1616,
            "content": "fetchWithTimeout(",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1622,
            "content": "fetchWithTimeout(",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1628,
            "content": "fetchWithTimeout(",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1634,
            "content": "fetchWithTimeout(",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1704,
            "content": "total_requests: REQUEST_METRICS.total,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1727,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1739,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1757,
            "content": "requestLog: any",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1766,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1775,
            "content": "const response = await fetch(query, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1853,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1865,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1883,
            "content": "requestLog: any",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1891,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1903,
            "content": "const response = await fetch(query, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1967,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1979,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1997,
            "content": "requestLog: any",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 1999,
            "content": "console.log(JSON.stringify({ ...requestLog, event: 'CONFIG_REQUEST' }));",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2002,
            "content": "const response = await fetch(",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2056,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2068,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2084,
            "content": "requestLog: any",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2086,
            "content": "console.log(JSON.stringify({ ...requestLog, event: 'HEALTH_REQUEST' }));",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2122,
            "content": "request_rate: calculateRequestRate(),",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2149,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2161,
            "content": "...requestLog,",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2190,
            "content": "const response = await fetch(",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2307,
            "content": "return fetch(query, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2322,
            "content": "return fetch(query, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2333,
            "content": "return fetch(query, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2438,
            "content": "const response = await fetch(`${supabaseUrl}/rest/v1/precios_proveedor?select=count&limit=1`, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2456,
            "content": "const response = await fetch(`${supabaseUrl}/functions/v1/scraper-maxiconsumo/health`, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2500,
            "content": "total_requests: REQUEST_METRICS.total",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2830,
            "content": "const response = await fetch(url, options);",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2847,
            "content": "async function fetchWithTimeout(url: string, options: any, timeoutMs: number): Promise<Response> {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2852,
            "content": "const response = await fetch(url, {",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2928,
            "content": "// Simplified request rate calculation",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2929,
            "content": "return REQUEST_METRICS.total / 3600; // requests per hour",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 2943,
            "content": "return REQUEST_METRICS.success / 60; // successful requests per minute",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 3005,
            "content": "const response = await fetch(",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 3033,
            "content": "const response = await fetch(",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          },
          {
            "line": 3530,
            "content": "throughput: estadisticas.length / Math.max(1, estadisticas.length), // requests per day",
            "issue": "HTTP request sin retry logic",
            "impact": "HIGH"
          }
        ],
        "data_validation": [
          {
            "line": 7,
            "content": "* - GET /proveedor/productos - Productos disponibles (con filtros avanzados)",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 35,
            "content": "const API_CACHE = new Map<string, { data: any; timestamp: number; ttl: number }>();",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 125,
            "content": "if (!['precios', 'productos', 'comparacion', 'sincronizar', 'status', 'alertas', 'estadisticas', 'co",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 132,
            "content": "'productos': 150,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 188,
            "content": "const cacheableEndpoints = ['status', 'precios', 'productos', 'alertas', 'estadisticas', 'health'];",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 219,
            "content": "case 'productos':",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 267,
            "content": "'productos': 120000, // 2 minutes",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 340,
            "content": "return entry.data;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 343,
            "content": "function addToAPICache(key: string, data: any, ttl: number): void {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 353,
            "content": "data,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 431,
            "content": "const productos = await response.json();",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 451,
            "content": "data: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 452,
            "content": "productos: productos,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 457,
            "content": "productos_mostrados: productos.length,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 479,
            "content": "* GET /proveedor/productos - Productos disponibles",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 494,
            "content": "console.log(`📦 Buscando productos - Búsqueda: ${busqueda}, Categoría: ${categoria}`);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 534,
            "content": "throw new Error(`Error obteniendo productos: ${response.statusText}`);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 537,
            "content": "const productos = await response.json();",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 544,
            "content": "data: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 545,
            "content": "productos: productos,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 547,
            "content": "total_productos: productos.length,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 548,
            "content": "productos_con_stock: productos.filter((p: any) => p.stock_disponible > 0).length,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 549,
            "content": "marcas_unicas: [...new Set(productos.map((p: any) => p.marca).filter(Boolean))].length,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 567,
            "content": "console.error('❌ Error obteniendo productos disponibles:', error);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 609,
            "content": "query += `&order=nombre_producto.asc`;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 635,
            "content": "data: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 733,
            "content": "data: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 783,
            "content": "// Obtener productos totales del proveedor",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 784,
            "content": "const productosTotalesResponse = await fetch(",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 795,
            "content": "if (productosTotalesResponse.ok) {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 796,
            "content": "const countData = await productosTotalesResponse.json();",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 836,
            "content": "data: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 844,
            "content": "productos_totales: totalProductos,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 852,
            "content": "'GET /proveedor/productos',",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 933,
            "content": "nuevos_productos: alertas.filter((a: any) => a.tipo_cambio === 'nuevo_producto').length",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 938,
            "content": "data: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1004,
            "content": "data: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1073,
            "content": "data: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1078,
            "content": "tipos_cambio: ['aumento', 'disminucion', 'nuevo_producto']",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1133,
            "content": "const productos = preciosResult.value;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1134,
            "content": "const total = countResult.status === 'fulfilled' ? countResult.value : productos.length;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1138,
            "content": "const productosConStats = await Promise.allSettled(",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1139,
            "content": "productos.map(async (producto: any) => {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1142,
            "content": "...producto,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1143,
            "content": "tendencias: producto.precio_anterior ? {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1144,
            "content": "cambio_absoluto: producto.precio_actual - producto.precio_anterior,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1145,
            "content": "cambio_porcentual: ((producto.precio_actual - producto.precio_anterior) / producto.precio_anterior *",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1146,
            "content": "direccion: producto.precio_actual > producto.precio_anterior ? 'subida' : 'bajada'",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1148,
            "content": "ultima_actualizacion_humanizada: formatTiempoTranscurrido(producto.ultima_actualizacion)",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1153,
            "content": "const productosFinales = productosConStats",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1159,
            "content": "data: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1160,
            "content": "productos: productosFinales,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1165,
            "content": "productos_mostrados: productosFinales.length,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1181,
            "content": "productos_procesados: productosFinales.length,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1190,
            "content": "productos: productosFinales.length,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1211,
            "content": "* GET /proveedor/productos - Productos disponibles (OPTIMIZADO)",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1242,
            "content": "const [productosResponse, statsResponse, facetasResponse] = await Promise.allSettled([",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1253,
            "content": "if (productosResponse.status === 'rejected') {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1254,
            "content": "throw new Error(`Error en consulta de productos: ${productosResponse.reason}`);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1257,
            "content": "const productos = await productosResponse.value.json();",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1260,
            "content": "const productosEnriquecidos = await Promise.allSettled(",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1261,
            "content": "productos.map(async (producto: any) => {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1263,
            "content": "...producto,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1264,
            "content": "precio_formateado: formatPrecio(producto.precio_actual),",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1265,
            "content": "stock_status: producto.stock_disponible > 0 ? 'disponible' : 'agotado',",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1266,
            "content": "categoria_slug: generateSlug(producto.categoria || ''),",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1267,
            "content": "etiquetas_busqueda: generateSearchTags(producto.nombre, producto.marca),",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1268,
            "content": "competitiveness_score: calculateCompetitivenessScore(producto)",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1273,
            "content": "const productosFinales = productosEnriquecidos",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1279,
            "content": "total_productos: productosFinales.length,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1280,
            "content": "productos_con_stock: productosFinales.filter((p: any) => p.stock_disponible > 0).length,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1281,
            "content": "marcas_unicas: [...new Set(productosFinales.map((p: any) => p.marca).filter(Boolean))].length,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1285,
            "content": "min: Math.min(...productosFinales.map((p: any) => p.precio_actual)),",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1286,
            "content": "max: Math.max(...productosFinales.map((p: any) => p.precio_actual)),",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1287,
            "content": "promedio: productosFinales.reduce((sum: number, p: any) => sum + p.precio_actual, 0) / productosFina",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1293,
            "content": "data: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1294,
            "content": "productos: productosFinales,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1304,
            "content": "relevancia_score: calculateRelevanceScore(productosFinales, busqueda),",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1315,
            "content": "productos: productosFinales.length,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1330,
            "content": "throw new Error(`Error obteniendo productos optimizado: ${error.message}`);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1410,
            "content": "data: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1415,
            "content": "patrones_productos: productPatterns?.status === 'fulfilled' ? productPatterns.value : null,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1545,
            "content": "productos_procesados: resultadoScraping.data?.productos_procesados || 0,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1547,
            "content": "resultadoComparacion.data?.oportunidades_encontradas || 0 : 0,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1554,
            "content": "data: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1574,
            "content": "productos: syncMetrics.productos_procesados,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1641,
            "content": "const [statsRes, productosRes, oportunidadesRes, configRes, scraperHealthRes] = statusPromises;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1647,
            "content": "const totalProductos = productosRes.status === 'fulfilled' && productosRes.value.ok ?",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1648,
            "content": "(await productosRes.value.json())[0]?.count || 0 : 0;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1664,
            "content": "database: totalProductos > 0,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1671,
            "content": "data: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1682,
            "content": "productos_totales: totalProductos,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1686,
            "content": "productos_nuevos_24h: ultimaEstadistica?.productos_nuevos || 0,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1697,
            "content": "database: totalProductos > 0 ? 'healthy' : 'unhealthy',",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1713,
            "content": "'GET /proveedor/productos',",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1730,
            "content": "productos: totalProductos",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1826,
            "content": "nuevos_productos: alertasFinales.filter((a: any) => a.tipo_cambio === 'nuevo_producto').length,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1833,
            "content": "data: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 1939,
            "content": "data: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2026,
            "content": "data: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2042,
            "content": "tipos_cambio: ['aumento', 'disminucion', 'nuevo_producto'],",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2109,
            "content": "database: dbHealth.status === 'fulfilled' ? dbHealth.value : { status: 'unhealthy', score: 0 },",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2131,
            "content": "data: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2169,
            "content": "data: {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2202,
            "content": "const productos = await response.json();",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2205,
            "content": "const categorias = productos.reduce((acc: any, producto: any) => {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2206,
            "content": "const cat = producto.categoria || 'Sin categoría';",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2213,
            "content": "cantidad_productos: cantidad",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2256,
            "content": "productos_promedio: 0,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2263,
            "content": "const productosTotales = estadisticas.reduce((sum, stat) => sum + (stat.productos_encontrados || 0),",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2264,
            "content": "const productosPromedio = Math.round(productosTotales / totalEjecuciones);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2272,
            "content": "productos_promedio: productosPromedio,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2327,
            "content": "}).then(res => res.json()).then(data => data[0]?.count || 0);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2338,
            "content": "}).then(res => res.json()).then(data => {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2339,
            "content": "const precios = data.map((item: any) => item.precio_actual);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2340,
            "content": "const totalStock = data.reduce((sum: number, item: any) => sum + (item.stock_disponible || 0), 0);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2347,
            "content": "productos_con_stock: data.filter((item: any) => item.stock_disponible > 0).length",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2396,
            "content": "case 'nombre_asc': query += `&order=nombre_producto.asc`; break;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2512,
            "content": "database_connection: 'healthy'",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2532,
            "content": "database: 0.25,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2567,
            "content": "if (!checks.database) score -= 30;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2638,
            "content": "function calculateCompetitivenessScore(producto: any): number {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2640,
            "content": "const hasStock = producto.stock_disponible > 0 ? 1 : 0;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2641,
            "content": "const priceReasonableness = producto.precio_actual > 0 ? 1 : 0;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2642,
            "content": "const hasInfo = producto.nombre && producto.marca ? 1 : 0;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2644,
            "content": "return Math.round((hasStock + priceReasonableness + hasInfo) / 3 * 100);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2647,
            "content": "function calculateRelevanceScore(productos: any[], searchTerm: string): number {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2651,
            "content": "productos.forEach(producto => {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2652,
            "content": "const nameMatch = producto.nombre?.toLowerCase().includes(searchTerm.toLowerCase()) ? 1 : 0;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2653,
            "content": "const brandMatch = producto.marca?.toLowerCase().includes(searchTerm.toLowerCase()) ? 1 : 0;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2657,
            "content": "return productos.length > 0 ? Math.round((totalScore / productos.length) * 100) : 0;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2706,
            "content": "const priceVolatility = Math.abs(oportunidad.diferencia_porcentual);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2709,
            "content": "if (priceVolatility > 20 || stockRisk === 'alto') return 'alto';",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2710,
            "content": "if (priceVolatility > 10 || stockRisk === 'medio') return 'medio';",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2751,
            "content": "productos_promedio: 0,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2760,
            "content": "const productosTotales = estadisticas.reduce((sum, stat) => sum + (stat.productos_encontrados || 0),",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2761,
            "content": "const productosPromedio = Math.round(productosTotales / totalEjecuciones);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2772,
            "content": "productos_promedio: productosPromedio,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2804,
            "content": "productos_totales: stats.reduce((sum, s) => sum + (s.productos_encontrados || 0), 0),",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2914,
            "content": "if (key.includes(`precios:${categoria}`) || key.includes(`productos:${categoria}`)) {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2962,
            "content": "if (components.database?.status === 'unhealthy') {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 2966,
            "content": "component: 'database'",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3012,
            "content": "const productos = await response.json();",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3013,
            "content": "const categorias = productos.reduce((acc: any, producto: any) => {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3014,
            "content": "const cat = producto.categoria || 'Sin categoría';",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3021,
            "content": "cantidad_productos: cantidad,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3022,
            "content": "porcentaje: Math.round((cantidad as number / productos.length) * 100)",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3040,
            "content": "const productos = await response.json();",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3043,
            "content": "marcas: [...new Set(productos.map((p: any) => p.marca).filter(Boolean))].length,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3044,
            "content": "categorias: [...new Set(productos.map((p: any) => p.categoria).filter(Boolean))].length,",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3046,
            "content": "min: Math.min(...productos.map((p: any) => p.precio_actual)),",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3047,
            "content": "max: Math.max(...productos.map((p: any) => p.precio_actual)),",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3048,
            "content": "promedio: productos.reduce((sum: number, p: any) => sum + p.precio_actual, 0) / productos.length",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3278,
            "content": "// Boost for significant price changes",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3325,
            "content": "price_movement: 'mixed',",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3355,
            "content": "'Priorizar productos con mayor diferencia de precio',",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3359,
            "content": "'Establecer monitoreo automático para productos clave',",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3438,
            "content": "const avgProducts = estadisticas.reduce((sum, s) => sum + (s.productos_encontrados || 0), 0) / estad",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3441,
            "content": "if (stat.productos_encontrados < avgProducts * 0.5) {",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3459,
            "content": "const avgProducts = estadisticas.reduce((sum, s) => sum + (s.productos_encontrados || 0), 0) / Math.",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3471,
            "content": "acc[date].products += stat.productos_encontrados || 0;",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          },
          {
            "line": 3486,
            "content": "const products = estadisticas.map(s => s.productos_encontrados || 0);",
            "issue": "Data extraction sin validación",
            "impact": "MEDIUM"
          }
        ],
        "selector_robustness": [],
        "accuracy_score": 0
      },
      "caching_opportunities": [
        {
          "line": 784,
          "type": "API_CACHING",
          "content": "const productosTotalesResponse = await fetch(",
          "opportunity": "Cache API calls de datos estáticos",
          "impact": "HIGH",
          "estimated_improvement": "60% reduction en DB calls"
        },
        {
          "line": 818,
          "type": "API_CACHING",
          "content": "const configResponse = await fetch(",
          "opportunity": "Cache API calls de datos estáticos",
          "impact": "HIGH",
          "estimated_improvement": "60% reduction en DB calls"
        },
        {
          "line": 1661,
          "type": "COMPUTATION_CACHING",
          "content": "const performanceScore = calculatePerformanceScore(REQUEST_METRICS);",
          "opportunity": "Cache resultados de computaciones costosas",
          "impact": "MEDIUM",
          "estimated_improvement": "40% reduction en CPU usage"
        },
        {
          "line": 1808,
          "type": "FILE_CACHING",
          "content": "action_required: determineActionRequired(alerta)",
          "opportunity": "Cache file operations",
          "impact": "MEDIUM",
          "estimated_improvement": "50% reduction en I/O wait"
        },
        {
          "line": 1828,
          "type": "FILE_CACHING",
          "content": "alertas_requieren_accion: alertasFinales.filter((a: any) => a.action_required).length",
          "opportunity": "Cache file operations",
          "impact": "MEDIUM",
          "estimated_improvement": "50% reduction en I/O wait"
        },
        {
          "line": 1918,
          "type": "COMPUTATION_CACHING",
          "content": "calculatePerformanceMetrics(estadisticas),",
          "opportunity": "Cache resultados de computaciones costosas",
          "impact": "MEDIUM",
          "estimated_improvement": "40% reduction en CPU usage"
        },
        {
          "line": 2136,
          "type": "COMPUTATION_CACHING",
          "content": "human_readable: formatUptime(calculateSystemUptime())",
          "opportunity": "Cache resultados de computaciones costosas",
          "impact": "MEDIUM",
          "estimated_improvement": "40% reduction en CPU usage"
        },
        {
          "line": 2519,
          "type": "COMPUTATION_CACHING",
          "content": "function calculatePerformanceScore(metrics: any): number {",
          "opportunity": "Cache resultados de computaciones costosas",
          "impact": "MEDIUM",
          "estimated_improvement": "40% reduction en CPU usage"
        },
        {
          "line": 3528,
          "type": "COMPUTATION_CACHING",
          "content": "function calculatePerformanceMetrics(estadisticas: any[]): any {",
          "opportunity": "Cache resultados de computaciones costosas",
          "impact": "MEDIUM",
          "estimated_improvement": "40% reduction en CPU usage"
        }
      ],
      "overall_performance_score": 0.0
    }
  }
}